<div class="container min-vh-100">
    <% if (locals.userEmpty) { %>
        <div class="d-flex">
            <h2>Book of <%= userEmpty[0].username %></h2>
            <% if (isFollowing) { %>
                <form action="/unfollow" method="post" class="ms-3">
                    <input type="hidden" name="userId" value="<%= userEmpty[0].id %>">
                    <button type="submit" class="btn btn-secondary w-100">
                        <i class="fas fa-user-check"></i>
                    </button>
                </form>
            <% } else { %>
                <form action="/follow" method="post" class="ms-3">
                    <input type="hidden" name="userId" value="<%= userEmpty[0].id %>">
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-user-plus"></i>
                    </button>
                </form>
            <% } %>
        </div>
        <div class="d-flex flex-column justify-content-center align-items-center min-vh-100">
            <p>Nenhum Livro Cadastrado!</p>
        </div>
    <% } else if (locals.searchedUser) { %>
        <div class="d-flex">
            <h2>Books of <%= searchedUser[0].username %></h2>
            <% if (isFollowing) { %>
                <form action="/unfollow" method="post" class="ms-3">
                    <input type="hidden" name="userId" value="<%= user_id %>">
                    <button type="submit" class="btn btn-secondary w-100">
                        <i class="fas fa-user-check"></i>
                    </button>
                </form>
            <% } else { %>
                <form action="/follow" method="post" class="ms-3">
                    <input type="hidden" name="userId" value="<%= user_id %>">
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-user-plus"></i>
                    </button>
                </form>
            <% } %>
        </div>
        <div class="cards-group">
            <% for (let user of searchedUser) { %>
                <div class="flip-card flip-horizontal-left">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <div class="card-profile d-flex align-items-center gap-2">
                                <% if (user.picture) { %>
                                    <img src="<%= user.picture %>" alt="Profile Picture">
                                <% } else { %>
                                    <i class="bi bi-person-fill fs-5"></i>
                                <% } %>
                                <p class="fw-bolder m-0"><%= user.username %></p>
                            </div>                            
                            
                            <div class="card-image">
                                <img src="https://covers.openlibrary.org/b/id/<%= user.cover %>-L.jpg" alt="book"
                                onclick="flipCard(this)">
                            </div>
    
                            <div class="card-stars d-flex text-warning gap-1">
                                <% for (let i = 0; i < user.rating; i++) { %>
                                    <i class="bi bi-star-fill"></i>
                                <% } %>
    
                                <% if (user.rating < 5) { %>
                                    <% for (let i = user.rating; i < 5; i++) { %>
                                        <i class="bi bi-star"></i>
                                    <% } %>
                                <% } %>
                            </div>
                        </div>
    
                        <div class="flip-card-back">
                            <div class="card-profile d-flex align-items-center gap-2">
                                <% if (user.picture) { %>
                                    <img src="<%= user.picture %>" alt="Profile Picture">
                                <% } else { %>
                                    <i class="bi bi-person-fill fs-5"></i>
                                <% } %>
                                <p class="fw-bolder m-0"><%= user.username %></p>
                            </div> 
    
                            <div class="card-body" onclick="flipCard(this)">
                                <div class="card-title">
                                    <h2>
                                        <%= user.title %>
                                    </h2>
                                    <p>By <%= user.author %></p>
                                </div>
    
                                <div class="card-text">
                                    <p><%= user.description %></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            <% } %>

            <div class="container my-5">
                <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center">
                        <% if (currentPage > 1) { %>
                            <li class="page-item">
                                <a class="page-link" href="?userId=<%= user_id %>&page=<%= currentPage - 1 %>" aria-label="Anterior">
                                <span aria-hidden="true">&laquo;</span>
                                <span class="sr-only">Anterior</span>
                                </a>
                            </li>
                        <% } %>
                
                        <% for (let i = 1; i <= totalPages; i++) { %>
                            <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                <a class="page-link" href="?userId=<%= user_id %>&page=<%= i %>"><%= i %></a>
                            </li>
                        <% } %>
                
                        <% if (currentPage < totalPages) { %>
                            <li class="page-item">
                                <a class="page-link" href="?userId=<%= user_id %>&page=<%= currentPage + 1 %>" aria-label="Próximo">
                                <span aria-hidden="true">&raquo;</span>
                                <span class="sr-only">Próximo</span>
                                </a>
                            </li>
                        <% } %>
                    </ul>
                </nav>
            </div> 
        </div>
    <% } %>
</div>

<div id="loading-screen" class="loading-screen d-none">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>